{
  "type": "gta",
  "display": "FiveM",
  "data": {
    "artifacts": {
      "type": "string",
      "value": "https://runtime.fivem.net/artifacts/fivem/build_proot_linux/master/4324-8b15f90861500a459afe7690869f7c7335df5c48/fx.tar.xz",
      "display": "Artifacts",
      "desc": "The artifacts link which you want to install (You can find them <a href='https://runtime.fivem.net/artifacts/fivem/build_proot_linux/master/'>here</a>)",
      "required": true,
      "userEdit": true
    },
    "description": {
      "type": "string",
      "value": "My FiveM Server",
      "display": "Description",
      "desc": "Server Description",
      "required": true,
      "userEdit": true
    },
    "license": {
      "type": "string",
      "value": "LICENTA",
      "display": "KEYMASTER license",
      "desc": "Your FiveM License Key (You can get from <a href='https://keymaster.fivem.net'>here</a>)",
      "required": true,
      "userEdit": true
    },
    "maxplayers": {
      "type": "integer",
      "value": 32,
      "display": "Slots",
      "desc": "The maximum number of players",
      "required": true,
      "userEdit": true
    },
    "port": {
      "type": "integer",
      "value": 30120,
      "display": "Port",
      "desc": "The port which server will be allocated",
      "required": true,
      "userEdit": true
    },
    "servername": {
      "type": "string",
      "value": "FXServer, but unconfigured",
      "display": "Name",
      "desc": "Server name",
      "required": true,
      "userEdit": true
    }
  },
  "install": [
    {
      "type": "download",
      "files": [
        "${artifacts}"
      ]
    },
    {
      "type": "command",
      "commands": [
        "tar xf fx.tar.xz",
        "mkdir -p server-data",
        "git clone --quiet https://github.com/citizenfx/cfx-server-data.git ./server-data",
        "chmod +x ./run.sh",
        "rm -f fx.tar.xz .wget-hsts"
      ]
    },
    {
      "type": "writefile",
      "text": "#!/bin/bash\n\ncd server-data\n../run.sh $* >&1| tee -a server_log.txt",
      "target": "start_no_edit.sh"
    },
    {
      "type": "writefile",
      "target": "server-data/server.cfg",
      "text": "# Only change the IP if you're using a server with multiple network interfaces, otherwise change the port only.\nendpoint_add_tcp \"0.0.0.0:${port}\"\nendpoint_add_udp \"0.0.0.0:${port}\"\n\nset mysql_connection_string \"server=localhost;database=vrp;userid=root;password=\"\n\n# These resources will start by default.\nensure mapmanager\nensure chat\nensure spawnmanager\nensure sessionmanager\nensure fivem\nensure hardcap\nensure rconlog\nensure scoreboard\n\n# This allows players to use scripthook-based plugins such as the legacy Lambda Menu.\n# Set this to 1 to allow scripthook. Do note that this does _not_ guarantee players won't be able to use external plugins.\nsv_scriptHookAllowed 0\n\n# Uncomment this and set a password to enable RCON. Make sure to change the password - it should look like rcon_password \"YOURPASSWORD\"\n#rcon_password \"\"\n\n# A comma-separated list of tags for your server.\n# For example:\n# - sets tags \"drifting, cars, racing\"\n# Or:\n# - sets tags \"roleplay, military, tanks\"\nsets tags \"default\"\n\n# A valid locale identifier for your server's primary language.\n# For example \"en-US\", \"fr-CA\", \"nl-NL\", \"de-DE\", \"en-GB\", \"pt-BR\"\nsets locale \"root-AQ\"\n# please DO replace root-AQ on the line ABOVE with a real language! :)\n\n# Set an optional server info and connecting banner image url.\n# Size doesn't matter, any banner sized image will be fine.\n#sets banner_detail \"https://url.to/image.png\"\n#sets banner_connecting \"https://url.to/image.png\"\n\n# Set your server's hostname\nsv_hostname \"${servername}\"\n\nsets sv_projectName \"${servername}\"\nsets sv_projectDesc \"${description}\"\n\n# Nested configs!\n#exec server_internal.cfg\n\n# Loading a server icon (96x96 PNG file)\n#load_server_icon myLogo.png\n\n# convars which can be used in scripts\nset temp_convar \"hey world!\"\n\n# Uncomment this line if you do not want your server to be listed in the server browser.\n# Do not edit it if you *do* want your server listed.\n#sv_master1 \"\"\n\n# Add system admins\nadd_ace group.admin command allow # allow all commands\nadd_ace group.admin command.quit deny # but don't allow quit\nadd_principal identifier.fivem:1 group.admin # add the admin to the group\n\n# Hide player endpoints in external log output.\nsv_endpointprivacy true\n\n# Server player slot limit (must be between 1 and 32, unless using OneSync)\nsv_maxclients ${maxplayers}\n\n# Steam Web API key, if you want to use Steam authentication (https://steamcommunity.com/dev/apikey)\n# -\u003e replace \"\" with the key\nset steam_webApiKey \"none\"\n\n# License key for your server (https://keymaster.fivem.net)\nsv_licenseKey \"${license}\""
    },
    {
      "type": "command",
      "commands": [
        "chmod +x start_no_edit.sh"
      ]
    }
  ],
  "run": {
    "command": "./start_no_edit.sh +exec server.cfg",
    "stopCode": 6,
    "stdin": {
      "type": "stdin"
    },
    "autostart": false,
    "autorecover": false,
    "autorestart": false
  },
  "environment": {
    "type": "host"
  },
  "supportedEnvironments": [
    {
      "type": "host"
    },
    {
      "type": "docker",
      "image": "pufferpanel/ubuntu",
      "portBindings": [
        "${port}:${port}/tcp"
      ]
    }
  ],
  "requirements": {
    "os": "linux",
    "arch": "amd64",
    "binaries": [
      "bash",
      "git",
      "wget"
    ]
  }
}
